services:
  qgis:
    build: .
    ports:
      - "7070:7070"
      - "80:80"
    environment:
      - DISPLAY=unix${DISPLAY}
      - QT_QPA_PLATFORM=offscreen
      # Note: run 'xhost +local:docker' beforehand.
    volumes:
      - /tmp/.X11-unix:/tmp/.X11-unix  # Allow GUI application to run in docker
      - .:/tests_directory/
      - profile-dir:/root/.local/share/QGIS/QGIS3/profiles/default
    command: qgis

volumes:
  profile-dir:
